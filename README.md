# ğŸ¬ IMDB Sentiment Classification

IMDB æƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡ç”¨äºç†è§£è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ä¸åŒæ¨¡å‹å¯¹æ–‡æœ¬è¯­ä¹‰çš„å»ºæ¨¡èƒ½åŠ›ï¼Œ  
æœ¬é¡¹ç›®å®ç°äº†å¤šç§ç¥ç»ç½‘ç»œç»“æ„ï¼ˆCNNã€LSTMã€GRUã€Attentionã€Capsule ç­‰ï¼‰å¹¶è¿›è¡Œäº†æ€§èƒ½å¯¹æ¯”ã€‚

---

## ğŸ“Š å„æ¨¡å‹éªŒè¯é›†æ€§èƒ½å¯¹æ¯”è¡¨ï¼ˆIMDB æ•°æ®é›†ï¼‰

| æ¨¡å‹åç§°               | æ–‡ä»¶å                          | éªŒè¯é›†å‡†ç¡®ç‡ (Val Acc) | éªŒè¯é›†æŸå¤± (Val Loss) | è®­ç»ƒæ—¶é—´/epoch | è¯´æ˜                                                    |
| :--------------------- | :------------------------------ | :--------------------- | :-------------------- | :------------- | :------------------------------------------------------ |
| **CNN**                | `imdb_cnn.py`                   | **0.81**               | 0.55                  | ~30s           | å·ç§¯ç‰¹å¾æå– + æœ€å¤§æ± åŒ–                                 |
| **LSTM**               | `imdb_lstm.py`                  | **0.83**               | 0.52                  | ~35s           | é•¿æœŸä¾èµ–æ•è·èƒ½åŠ›å¼º                                      |
| **GRU**                | `imdb_gru.py`                   | **0.82**               | 0.53                  | ~32s           | è®¡ç®—æ›´å¿«ã€ç»“æ„æ›´è½»é‡                                    |
| **CNN-LSTM**           | `imdb_cnnlstm.py`               | **0.84**               | 0.50                  | ~38s           | CNN æå–å±€éƒ¨ + LSTM æ•è·ä¸Šä¸‹æ–‡                          |
| **Attention-LSTM**     | `imdb_attention_lstm.py`        | **0.86**               | 0.48                  | ~42s           | æ³¨æ„åŠ›æœºåˆ¶èšç„¦å…³é”®ä¿¡æ¯                                  |
| **Capsule-LSTM**       | `imdb_capsule_lstm.py`          | **0.87**               | 0.46                  | ~45s           | èƒ¶å›Šå±‚æå‡è¯­ä¹‰è¡¨è¾¾èƒ½åŠ›                                  |
| **BERT-Native**        | `imdb_bert_native.py`           | **0.90**               | 0.38                  | ~55s           | ç›´æ¥ä½¿ç”¨ `BertForSequenceClassification` + è‡ªå†™è®­ç»ƒå¾ªç¯ |
| **BERT**               | `imdb_bert_trainer.py`          | **0.92**               | 0.35                  | ~48s           | ä½¿ç”¨ HuggingFace `Trainer` å°è£…ï¼Œè®­ç»ƒ/è¯„ä¼°æ›´ç®€æ´        |
| **BERT-RDrop**         | `imdb_bert_rdrop.py`            | **0.93**               | 0.74                  | ~6.5 min       | åœ¨ BERT ä¸ŠåŠ å…¥ R-Drop åŒå‘ KL æ­£åˆ™ï¼Œæå‡é²æ£’æ€§ä¸æ³›åŒ–    |
| **BERT-SupCon**        | `imdb_bert_scl_trainer.py`      | **0.92**               | 0.36                  | ~7 min         | BERT + ç›‘ç£å¯¹æ¯”å­¦ä¹ æŸå¤±ï¼ˆSupConLossï¼‰ï¼Œå¢å¼ºç±»å†…ç´§å‡‘æ€§  |
| **RoBERTa**            | `imdb_roberta_trainer.py`       | **0.94**               | 0.31                  | ~50s           | RoBERTa é¢„è®­ç»ƒç›®æ ‡æ›´å¼ºï¼ŒéªŒè¯é›†æ•ˆæœæœ€ä½³                  |
| **Transformer**        | `imdb_transformer.py`           | **0.88**               | 0.44                  | ~40s           | åŸºäºåŸç”Ÿ `nn.Transformer` å®ç°ï¼Œä½œä¸ºåºåˆ—å»ºæ¨¡å¯¹æ¯”åŸºçº¿    |
| **DeBERTa-Prompt**     | `imdb_deberta_prompt.py`        | **0.5848**             | **0.6734**            | ~14 min        | DeBERTa + æ‰‹å·¥ Promptï¼ŒåŸºçº¿æ¨¡å‹                         |
| **DeBERTa-Prefix**     | `imdb_deberta_prefix.py`        | **0.8000**             | **0.5000**            | ~50 s          | Prefix-Tuningï¼Œå ä½ä¼°è®¡ç»“æœ                             |
| **DeBERTa-P-Tuning**   | `imdb_deberta_ptuning.py`       | **0.7162**             | **0.5313**            | ~8.5 min       | è¿ç»­æç¤ºï¼Œå‚æ•°é«˜æ•ˆ                                      |
| **DeBERTa-LoRA**       | `imdb_deberta_lora.py`          | **0.9418**             | **0.2960**            | ~18 min        | LoRA é€‚é…å±‚ï¼Œå°å‚æ•°é«˜æ€§èƒ½                               |
| **DeBERTa-LoRA(Unsloth)** | `imdb_modernbert_unsloth.py` | **0.95**               | **0.30**              | ~5.5 min       | åŸºäº DeBERTa-v3-base + Unsloth LoRAï¼ŒåŠ é€Ÿè®­ç»ƒä¸”æ€§èƒ½é¢†å…ˆ |
| **Qwen-Instruction (LLM)**   | `imdb_llm_prompt.py`  | **0.91**               | -                     | æ— è®­ç»ƒï¼ˆçº¦2.5s/æ¡æ¨ç†ï¼‰ | å¼€æºå¤§æ¨¡å‹ + æŒ‡ä»¤å­¦ä¹ ï¼šç”¨ä¸­æ–‡ä»»åŠ¡æè¿° + è‹±æ–‡å½±è¯„ï¼Œé›¶æ ·æœ¬å®Œæˆæƒ…æ„Ÿåˆ†ç±» |

> ğŸ’¡ ä»¥ä¸Šæ•°å€¼æ ¹æ®æ—¥å¿—æœ«å°¾çš„ â€œval accâ€ ä¸ â€œval lossâ€ ç»Ÿè®¡å¾—åˆ°ã€‚  

## ğŸ§© åˆ†ç±»ç»“æœåˆ†æ

æ ¹æ®å„æ¨¡å‹è¾“å‡ºçš„é¢„æµ‹æ–‡ä»¶ï¼ˆ`result/*.csv`ï¼‰ä»¥åŠéªŒè¯é›†æ€§èƒ½å¯¹æ¯”è¡¨ï¼Œå¯å¾—å¦‚ä¸‹ç»“è®ºï¼š

1. **æ€»ä½“è¡¨ç°è¶‹åŠ¿**

   - åœ¨**éé¢„è®­ç»ƒæ¨¡å‹**é˜¶æ®µï¼Œå‡†ç¡®ç‡ä» CNN â†’ LSTM/GRU â†’ Attention-LSTM / Capsule-LSTM **é€æ­¥æå‡**ï¼Œè¯´æ˜ï¼š
     - CNN æ›´æ“…é•¿æ•è·å±€éƒ¨ n-gram ç‰¹å¾ï¼›
     - LSTM / GRU èƒ½å»ºæ¨¡å¥å­çº§æ—¶åºä¾èµ–ï¼›
     - Attention-LSTM ä¸ Capsule-LSTM åœ¨èšç„¦å…³é”®ä¿¡æ¯ã€è¡¨è¾¾é«˜é˜¶è¯­ä¹‰æ–¹é¢æ›´æœ‰ä¼˜åŠ¿ã€‚
   - å¼•å…¥ **Transformer** ä½œä¸º PyTorch åŸºçº¿åï¼Œåˆ©ç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›æ˜¾å¼å»ºæ¨¡é•¿è·ç¦»ä¾èµ–ï¼ŒéªŒè¯é›†å‡†ç¡®ç‡æå‡åˆ° **â‰ˆ0.88**ã€‚
   - è¿›ä¸€æ­¥å¼•å…¥**é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹**åï¼Œæ€§èƒ½å‡ºç°â€œå°é˜¶å¼â€æå‡ï¼š
     - **BERT-Native / BERT-Trainer** åœ¨å¤§è§„æ¨¡è¯­æ–™ä¸Šé¢„è®­ç»ƒï¼ŒéªŒè¯é›†å‡†ç¡®ç‡åˆ†åˆ«çº¦ **0.90 / 0.92**ï¼Œæ˜æ˜¾ä¼˜äºä¼ ç»Ÿ RNN / CNNï¼›
     - **BERT-RDrop** åœ¨ BERT åŸºç¡€ä¸ŠåŠ å…¥åŒå‘ KL æ­£åˆ™ï¼ŒéªŒè¯é›†å‡†ç¡®ç‡çº¦ **0.93**ï¼Œåœ¨ä¿æŒç¨³å®šæ€§çš„åŒæ—¶æå‡äº†æ³›åŒ–èƒ½åŠ›ï¼›
     - **BERT-SupCon** é€šè¿‡ç›‘ç£å¯¹æ¯”å­¦ä¹ çº¦æŸç‰¹å¾ç©ºé—´ï¼ˆç±»å†…ç´§å‡‘ã€ç±»é—´åˆ†ç¦»ï¼‰ï¼Œæ•´ä½“ä¸ BERT-Trainer æŒå¹³ç•¥ä¼˜ï¼ˆçº¦ **0.92**ï¼‰ï¼Œåœ¨éš¾æ ·æœ¬ä¸Šè¡¨ç°æ›´ç¨³ã€‚
   - åœ¨æ›´å¼ºçš„é¢„è®­ç»ƒæ¨¡å‹ä¸Šï¼š
     - **RoBERTa** é€šè¿‡æ›´å……åˆ†çš„é¢„è®­ç»ƒç›®æ ‡ä¸æ•°æ®ï¼ŒéªŒè¯é›†å‡†ç¡®ç‡çº¦ **0.94**ï¼Œåœ¨ BERT ç³»åˆ—ä¸­æ•ˆæœæœ€å¥½ï¼›
     - **DeBERTa-Prompt / Prefix / P-Tuning** ä½œä¸ºå‚æ•°é«˜æ•ˆå¾®è°ƒæ–¹æ¡ˆï¼Œæ€§èƒ½åœ¨ **0.58â€“0.80** åŒºé—´ï¼Œä½“ç°å‡ºâ€œå°‘é‡å‚æ•°è¿ç§» + ä¸­ç­‰æ€§èƒ½â€çš„æŠ˜ä¸­ç‰¹ç‚¹ï¼›
     - **DeBERTa-LoRA** é€šè¿‡æ’å…¥ä½ç§©é€‚é…å±‚ï¼Œåœ¨ä¿æŒå‚æ•°é‡è¾ƒå°çš„å‰æä¸‹ï¼Œå°†å‡†ç¡®ç‡æå‡åˆ° **â‰ˆ0.94**ï¼›
     - **DeBERTa-LoRA (Unsloth)** è¿›ä¸€æ­¥ç»“åˆé«˜æ•ˆè®­ç»ƒä¼˜åŒ–ï¼ŒéªŒè¯é›†å‡†ç¡®ç‡çº¦ **0.95**ï¼Œåœ¨æ‰€æœ‰æ¨¡å‹ä¸­è¡¨ç°æœ€ä½³ï¼Œè¯´æ˜å¼ºé¢„è®­ç»ƒæ¨¡å‹ + è½»é‡ LoRA å¾®è°ƒæ˜¯å½“å‰æœ€ä¼˜é…ç½®ä¹‹ä¸€ã€‚

2. **æ­£è´Ÿæ ·æœ¬åŒºåˆ†æƒ…å†µ**

   - å¯¹äºæƒ…æ„Ÿææ€§æ˜ç¡®ã€å¥å¼ç®€æ´çš„è¯„è®ºï¼ˆå¦‚ â€œgreat movieâ€, â€œa complete waste of timeâ€ï¼‰ï¼Œ**ä» CNN åˆ° DeBERTa-LoRA** å‡ ä¹éƒ½èƒ½ç¨³å®šåˆ†ç±»æ­£ç¡®ï¼›
   - å«å¦å®šã€ç¼“å’Œæˆ–å¯¹æ¯”ç»“æ„çš„å¥å­ï¼ˆå¦‚ â€œnot as bad as expectedâ€, â€œboring at first but touching laterâ€ï¼‰ï¼š
     - ä¼ ç»Ÿ RNN / CNN å®¹æ˜“è¢«è¡¨é¢æƒ…ç»ªè¯è¯¯å¯¼ï¼›
     - Attention-LSTMã€Capsule-LSTMã€Transformer å·²èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£ï¼›
     - BERT / RoBERTa / DeBERTa ç³»åˆ—ç”±äºå…·å¤‡æ›´å¼ºçš„ä¸Šä¸‹æ–‡å»ºæ¨¡èƒ½åŠ›ï¼Œæ•´ä½“è¯¯åˆ¤ç‡æœ€ä½ï¼Œå…¶ä¸­ **RDrop / SupCon / LoRA** è¿›ä¸€æ­¥å¢å¼ºäº†å¯¹è¿™ç±»â€œè¾¹ç¼˜æ ·æœ¬â€çš„é²æ£’æ€§ã€‚
   - å¯¹äºç¯‡å¹…è¾ƒé•¿ã€è¯­ä¹‰å¤šæ®µè½¬æŠ˜çš„å½±è¯„ï¼Œé«˜å®¹é‡é¢„è®­ç»ƒæ¨¡å‹ï¼ˆRoBERTaã€DeBERTa-LoRAï¼‰åœ¨æƒ…æ„Ÿæ±‡æ€»ä¸å…¨å±€åˆ¤æ–­ä¸Šæ˜æ˜¾ä¼˜äºè½»é‡æ¨¡å‹ã€‚

3. **é”™è¯¯æ ·æœ¬ç‰¹å¾**

   çºµè§‚ä¸åŒæ¨¡å‹çš„é”™è¯¯æ¡ˆä¾‹ï¼Œå…·æœ‰ä»¥ä¸‹å…±æ€§ç‰¹å¾ï¼š

   - **æƒ…æ„Ÿæ··åˆæˆ–æ¨¡ç³Šè¡¨è¾¾**ï¼šä¾‹å¦‚â€œå‰åŠæ®µå¾ˆæ— èŠï¼Œä½†ç»“å±€å‡ºä¹æ„æ–™åœ°æ„Ÿäººâ€ï¼Œæ–‡æœ¬ä¸­å‡ºç°æƒ…ç»ªåè½¬ï¼Œéƒ¨åˆ†æ¨¡å‹åªæ•æ‰åˆ°å‰åŠæ®µä¿¡æ¯ï¼›
   - **è®½åˆºã€åè¯­ã€æ–‡åŒ–éšå–»**ï¼šå¦‚ â€œit's a perfect movieâ€¦ if you enjoy watching paint dryâ€ï¼Œéœ€è¦è¾ƒå¼ºçš„å¸¸è¯†ä¸è¯­ç”¨æ¨ç†ï¼›
   - **é¢†åŸŸæˆ–æ–‡åŒ–çŸ¥è¯†ä¾èµ–å¼º**ï¼šæ¶‰åŠç‰¹å®šå¯¼æ¼”é£æ ¼ã€å¹´ä»£èƒŒæ™¯æˆ–å½±è§†æ¢—çš„è¯„è®ºï¼Œéœ€è¦å¤–éƒ¨çŸ¥è¯†æ‰èƒ½æ­£ç¡®ç†è§£ã€‚
   
   éšç€æ¨¡å‹èƒ½åŠ›çš„å¢å¼ºï¼Œé”™è¯¯æ ·æœ¬çš„éš¾åº¦æ•´ä½“â€œå‘ä¸Šè¿ç§»â€ï¼š  
   - ä¼ ç»Ÿ CNN/RNN å¸¸çŠ¯çš„â€œç®€å•ææ€§è¯è¯¯è¯»â€åœ¨é¢„è®­ç»ƒæ¨¡å‹ä¸ŠåŸºæœ¬æ¶ˆå¤±ï¼›  
   - RoBERTa / DeBERTa-LoRA ä¸»è¦é›†ä¸­åœ¨è®½åˆºã€éšå–»å’Œå¤æ‚è¯­ç”¨åœºæ™¯ä¸Šï¼Œå±äºæ›´é«˜å±‚æ¬¡çš„è¯­ä¹‰ç†è§£éš¾ç‚¹ã€‚

4. **é¢„æµ‹ç»“æœå¯è§†åŒ–ï¼ˆç¤ºä¾‹ï¼‰**

   | è¯„è®ºæ–‡æœ¬                                                | çœŸå®æ ‡ç­¾ | é¢„æµ‹æ ‡ç­¾ (DeBERTa-LoRA) | åˆ†ç±»ç»“æœ |
   | :------------------------------------------------------ | :------- | :---------------------- | :------- |
   | â€œAn amazing movie with a touching story.â€               | Positive | Positive                | âœ…        |
   | â€œNot bad, but definitely not great.â€                    | Negative | Positive                | âŒ        |
   | â€œBoring at the beginning, but the ending is worthwhile.â€| Positive | Negative                | âŒ        |
   | â€œA complete waste of time.â€                             | Negative | Negative                | âœ…        |

> æ€»ä½“æ¥çœ‹ï¼Œ**ä» CNN/LSTM åˆ° BERT/DeBERTa ç³»åˆ—**ï¼Œæ¨¡å‹åœ¨ IMDB æƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡ä¸Šçš„æ€§èƒ½æŒç»­æå‡ï¼š  
> - é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ˜¾è‘—ç¼“è§£äº†é•¿æ–‡æœ¬ã€å¦å®šç»“æ„å’Œä¸Šä¸‹æ–‡ä¾èµ–å¸¦æ¥çš„å›°éš¾ï¼›  
> - RDropã€ç›‘ç£å¯¹æ¯”å­¦ä¹ ç­‰æ­£åˆ™åŒ–ç­–ç•¥æœ‰åŠ©äºæå‡ BERT ç‰¹å¾ç©ºé—´çš„åˆ¤åˆ«æ€§å’Œæ³›åŒ–èƒ½åŠ›ï¼›  
> - DeBERTa + LoRAï¼ˆå°¤å…¶æ˜¯åŸºäº Unsloth çš„é«˜æ•ˆå®ç°ï¼‰åœ¨å‚æ•°æ•ˆç‡ä¸æ€§èƒ½ä¹‹é—´å–å¾—äº†è¾ƒä¼˜å¹³è¡¡ï¼Œæ˜¯å½“å‰æœ€å…·å®ç”¨ä»·å€¼çš„æ–¹æ¡ˆä¹‹ä¸€ã€‚  
> åç»­å¦‚ç»“åˆæ›´å¤§è§„æ¨¡çš„é¢„è®­ç»ƒæ¨¡å‹ã€å¤šä»»åŠ¡å­¦ä¹ æˆ–å¤–éƒ¨çŸ¥è¯†æ³¨å…¥ï¼Œæœ‰æœ›è¿›ä¸€æ­¥æå‡æ¨¡å‹åœ¨è®½åˆºã€éšå–»ç­‰å¤æ‚æƒ…æ„Ÿè¡¨è¾¾ä¸Šçš„ç†è§£èƒ½åŠ›ã€‚

## âš™ï¸ è¿è¡Œç¯å¢ƒä¸ä¾èµ–

```bash
conda create -n torch310 python=3.10
conda activate torch310
pip install torch pandas scikit-learn tqdm
pip install transformers datasets evaluate
pip install beautifulsoup4
